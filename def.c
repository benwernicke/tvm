#include "def.h"

const char* reg_str_map[] = {
    [R00] = "r00",
    [R01] = "r01",
    [R02] = "r02",
    [R03] = "r03",
    [R04] = "r04",
    [R05] = "r05",
    [R06] = "r06",
    [R07] = "r07",
    [R08] = "r08",
    [R09] = "r09",
    [R10] = "r10",
    [R11] = "r11",
    [R12] = "r12",
    [R13] = "r13",
    [R14] = "r14",
    [R15] = "r15",
    [RIP] = "rip",
    [RSP] = "rsp",
    [RET] = "ret",
};

const uint64_t reg_bin_map[] = {
    [R00] = 0,
    [R01] = 1,
    [R02] = 2,
    [R03] = 3,
    [R04] = 4,
    [R05] = 5,
    [R06] = 6,
    [R07] = 7,
    [R08] = 8,
    [R09] = 9,
    [R10] = 10,
    [R11] = 11,
    [R12] = 12,
    [R13] = 13,
    [R14] = 14,
    [R15] = 15,
    [RIP] = 16,
    [RSP] = 17,
    [RET] = 18,
};

const uint64_t reg_maps_size = sizeof(reg_bin_map) / sizeof(*reg_bin_map);

const char* instr_str_map[] = {
    [INSTR_MOV]     = "mov",
    [INSTR_CMOV]    = "cmov",
    [INSTR_LEA]     = "lea",
    [INSTR_JMP]     = "jmp",
    [INSTR_CJMP]    = "cjmp",
    [INSTR_CALL]    = "call",
    [INSTR_RETURN]  = "return",
    [INSTR_PUSH]    = "push",
    [INSTR_POP]     = "pop",
    [INSTR_STOR]    = "stor",
    [INSTR_LOAD]    = "load",
    [INSTR_ADD]     = "add",
    [INSTR_SUB]     = "sub",
    [INSTR_MUL]     = "mul",
    [INSTR_DIV]     = "div",
    [INSTR_MOD]     = "mod",
    [INSTR_AND]     = "and",
    [INSTR_OR]      = "or",
    [INSTR_XOR]     = "xor",
    [INSTR_SL]      = "sl",
    [INSTR_SR]      = "sr",
    [INSTR_EQ]      = "eq",
    [INSTR_NEQ]     = "neq",
    [INSTR_GT]      = "gt",
    [INSTR_GEQ]     = "geq",
    [INSTR_LT]      = "lt",
    [INSTR_LEQ]     = "leq",
    [INSTR_NOT]     = "not",
    [INSTR_COMP]    = "comp",
    [INSTR_EXIT]    = "exit",
    [INSTR_SYSCALL] = "syscall",
    [INSTR_INC]     = "inc",
    [INSTR_DEC]     = "dec",
    [INSTR_PRNT]    = "prnt",
};

const uint64_t instr_bin_map[] = {
    [INSTR_MOV]     = 0  << 8,
    [INSTR_CMOV]    = 1  << 8,
    [INSTR_LEA]     = 2  << 8,
    [INSTR_JMP]     = 3  << 8,
    [INSTR_CJMP]    = 4  << 8,
    [INSTR_CALL]    = 5  << 8,
    [INSTR_RETURN]  = 6  << 8,
    [INSTR_PUSH]    = 7  << 8,
    [INSTR_POP]     = 8  << 8,
    [INSTR_STOR]    = 9  << 8,
    [INSTR_LOAD]    = 10 << 8,
    [INSTR_ADD]     = 11 << 8,
    [INSTR_SUB]     = 12 << 8,
    [INSTR_MUL]     = 13 << 8,
    [INSTR_DIV]     = 14 << 8,
    [INSTR_MOD]     = 15 << 8,
    [INSTR_AND]     = 16 << 8,
    [INSTR_OR]      = 17 << 8,
    [INSTR_XOR]     = 18 << 8,
    [INSTR_SL]      = 19 << 8,
    [INSTR_SR]      = 20 << 8,
    [INSTR_EQ]      = 21 << 8,
    [INSTR_NEQ]     = 22 << 8,
    [INSTR_GT]      = 23 << 8,
    [INSTR_GEQ]     = 24 << 8,
    [INSTR_LT]      = 25 << 8,
    [INSTR_LEQ]     = 26 << 8,
    [INSTR_NOT]     = 27 << 8,
    [INSTR_COMP]    = 28 << 8,
    [INSTR_EXIT]    = 29 << 8,
    [INSTR_SYSCALL] = 30 << 8,
    [INSTR_INC]     = 31 << 8,
    [INSTR_DEC]     = 32 << 8,
    [INSTR_PRNT]    = 33 << 8,
};

const arg_t instr_arg_map[][INSTR_ARG_MAX] = {
    [INSTR_MOV]     = { ARG_RR, ARG_RL },
    [INSTR_CMOV]    = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_LEA]     = { ARG_RL, ARG_RR },
    [INSTR_JMP]     = { ARG_R, ARG_L },
    [INSTR_CJMP]    = { ARG_RR, ARG_LR, ARG_RL, ARG_LL },
    [INSTR_CALL]    = { ARG_R, ARG_L },
    [INSTR_RETURN]  = { ARG_N },
    [INSTR_PUSH]    = { ARG_R },
    [INSTR_POP]     = { ARG_R },
    [INSTR_STOR]    = { ARG_RRR, ARG_RRL, ARG_RLR, ARG_RLL },
    [INSTR_LOAD]    = { ARG_RRR, ARG_RRL },
    [INSTR_ADD]     = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_SUB]     = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_MUL]     = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_DIV]     = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_MOD]     = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_AND]     = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_OR]      = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_XOR]     = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_SL]      = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_SR]      = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_EQ]      = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_NEQ]     = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_GT]      = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_GEQ]     = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_LT]      = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_LEQ]     = { ARG_RRR, ARG_RLR, ARG_RRL, ARG_RLL },
    [INSTR_NOT]     = { ARG_RL, ARG_RR },
    [INSTR_COMP]    = { ARG_RL, ARG_RR },
    [INSTR_EXIT]    = { ARG_R, ARG_L },
    [INSTR_SYSCALL] = { ARG_N },
    [INSTR_INC]     = { ARG_R },
    [INSTR_DEC]     = { ARG_R },
    [INSTR_PRNT]    = { ARG_R, ARG_L },
};

const uint64_t instr_arg_num_map[] = {
    [INSTR_MOV]     = 2,
    [INSTR_CMOV]    = 3,
    [INSTR_LEA]     = 2,
    [INSTR_JMP]     = 1,
    [INSTR_CJMP]    = 2,
    [INSTR_CALL]    = 1,
    [INSTR_RETURN]  = 0,
    [INSTR_PUSH]    = 1,
    [INSTR_POP]     = 1,
    [INSTR_STOR]    = 3,
    [INSTR_LOAD]    = 3,
    [INSTR_ADD]     = 3,
    [INSTR_SUB]     = 3,
    [INSTR_MUL]     = 3,
    [INSTR_DIV]     = 3,
    [INSTR_MOD]     = 3,
    [INSTR_AND]     = 3,
    [INSTR_OR]      = 3,
    [INSTR_XOR]     = 3,
    [INSTR_SL]      = 3,
    [INSTR_SR]      = 3,
    [INSTR_EQ]      = 3,
    [INSTR_NEQ]     = 3,
    [INSTR_GT]      = 3,
    [INSTR_GEQ]     = 3,
    [INSTR_LT]      = 3,
    [INSTR_LEQ]     = 3,
    [INSTR_NOT]     = 2,
    [INSTR_COMP]    = 2,
    [INSTR_EXIT]    = 1,
    [INSTR_SYSCALL] = 0,
    [INSTR_INC]     = 1,
    [INSTR_DEC]     = 1,
    [INSTR_PRNT]    = 1,
};

const uint64_t instr_arg_max_permutation[] = {
    [INSTR_MOV]     = 2,
    [INSTR_CMOV]    = 4,
    [INSTR_LEA]     = 2,
    [INSTR_JMP]     = 2,
    [INSTR_CJMP]    = 4,
    [INSTR_CALL]    = 2,
    [INSTR_RETURN]  = 1,
    [INSTR_PUSH]    = 1,
    [INSTR_POP]     = 1,
    [INSTR_STOR]    = 4,
    [INSTR_LOAD]    = 2,
    [INSTR_ADD]     = 4,
    [INSTR_SUB]     = 4,
    [INSTR_MUL]     = 4,
    [INSTR_DIV]     = 4,
    [INSTR_MOD]     = 4,
    [INSTR_AND]     = 4,
    [INSTR_OR]      = 4,
    [INSTR_XOR]     = 4,
    [INSTR_SL]      = 4,
    [INSTR_SR]      = 4,
    [INSTR_EQ]      = 4,
    [INSTR_NEQ]     = 4,
    [INSTR_GT]      = 4,
    [INSTR_GEQ]     = 4,
    [INSTR_LT]      = 4,
    [INSTR_LEQ]     = 4,
    [INSTR_NOT]     = 2,
    [INSTR_COMP]    = 2,
    [INSTR_EXIT]    = 2,
    [INSTR_SYSCALL] = 1,
    [INSTR_INC]     = 1,
    [INSTR_DEC]     = 1,
    [INSTR_PRNT]    = 2,
};

const uint64_t instr_maps_size = sizeof(instr_bin_map) / sizeof(*instr_bin_map);

const char* arg_str_map[] = {
    [ARG_N]   = "none",
    [ARG_L]   = "<literal>",
    [ARG_R]   = "<reg>",
    [ARG_LL]  = "<literal> <literal>",
    [ARG_RL]  = "<reg> <literal>",
    [ARG_LR]  = "<literal> <reg>",
    [ARG_RR]  = "<reg> <reg>",
    [ARG_LLR] = "<literal> <literal> <reg>",
    [ARG_RLR] = "<reg> <literal> <reg>",
    [ARG_LRR] = "<literal> <reg> <reg>",
    [ARG_RRR] = "<reg> <reg> <reg>",
    [ARG_LLL] = "<literal> <literal> <literal>",
    [ARG_RLL] = "<reg> <literal> <literal>",
    [ARG_LRL] = "<literal> <reg> <literal>",
    [ARG_RRL] = "<reg> <reg> <literal>",
};

const uint64_t arg_bin_map[] = {
    [ARG_N]   = 0,
    [ARG_L]   = 1,
    [ARG_R]   = 2,
    [ARG_LL]  = 3,
    [ARG_RL]  = 4,
    [ARG_LR]  = 5,
    [ARG_RR]  = 6,
    [ARG_LLR] = 7,
    [ARG_RLR] = 8,
    [ARG_LRR] = 9,
    [ARG_RRR] = 10,
    [ARG_LLL] = 11,
    [ARG_RLL] = 12,
    [ARG_LRL] = 13,
    [ARG_RRL] = 14,
};

const uint64_t arg_maps_size = sizeof(arg_bin_map) / sizeof(*arg_bin_map);
